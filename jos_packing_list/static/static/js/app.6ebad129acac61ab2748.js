webpackJsonp([1],{JHOU:function(module,__webpack_exports__,__webpack_require__){"use strict";var mixins={data:function(){return{}},mounted:function(){},methods:{getNewDay:function(t,e){t=t.split("/");var i=new Date(t[1]+"/"+t[2]+"/"+t[0]),a=Math.abs(i)+24*e*60*60*1e3,s=new Date(a),n=s.getFullYear(),r=s.getMonth()+1;r<10&&(r="0"+r);var o=s.getDate();return o<10&&(o="0"+o),n+"/"+r+"/"+o},sum:function sum(arr){return eval(arr.join("+"))},diglogTrigger:function(t,e){this["show_"+t]=e},closeDialog:function(){this.index=0,eventBus.$emit("f-close-dialog",this.tmpName,!1)},printPDF:function(t,e){this.$axios({url:t,method:"POST",responseType:"arraybuffer",params:{Token:e}}).then(function(t){if(0==t.state)return alert(t.errmsg);var e=new Blob([t],{type:"application/pdf"}),i=window.URL.createObjectURL(e);window.open(i)})}}};__webpack_exports__.a=mixins},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("//Fk"),s=i.n(a),n=(i("ShJz"),i("7+uW")),r=i("Xxa5"),o=i.n(r),l=i("exGp"),c=i.n(l),d=i("woOf"),u=i.n(d),_=i("JHOU"),h={name:"ReportDialog",mixins:[_.a],data:function(){return{tmpName:"ReportDialog",store_name:[],isFilter:!1,isSearched:!1,formdata:[],linesFormData:[],titles:[{name:"出库单号",width:"10%"},{name:"装箱单号",width:"10%"},{name:"商业伙伴",width:"10%"},{name:"仓库",width:"10%"},{name:"箱数/箱号",width:"10%"},{name:"创建时间",width:"10%"},{name:"创建用户",width:"10%"},{name:"执行时间",width:"10%"},{name:"执行用户",width:"10%"}],date:[],date2:{start_date:"",end_date:""},form_code:"",code:"",total:"",totalMain:"",totalSub:"",limit:10,disableBack:!0,timeout:null,isLine:!1}},mounted:function(){var t=[],e=new Date,i=e.getFullYear(),a=e.getMonth()+1,s=e.getDate();t[0]=i+"/"+a+"/1",t[1]=i+"/"+a+"/"+s,this.date=t,this.date2.start_date=t[0],this.date2.end_date=t[1]},watch:{date:{handler:function(t,e){this.date2.start_date=t[0],this.date2.end_date=t[1]}},date2:{handler:function(t,e){this.date=[t.start_date,t.end_date]},deep:!0}},methods:{toLines:function(t,e,i){var a=this;(i=(i-1)*this.limit||0)<0&&(i=0);var s={start_date:this.date[0],end_date:this.date[1]?this.getNewDay(this.date[1],1):"",form_code:this.form_code,code:t||this.code,start:i,limit:this.limit};this.$axios({url:"/api/packing_reports?action=packing_line",params:s}).then(function(t){return 1===t.state?(a.disableBack=!1,a.totalSub=t.total,a.total=t.total,a.linesFormData=t.results,a.isLine=!0,void(a.code=t.code)):alert(t.errmsg)})},handleCurrentChange:function(t){this.isLine&&this.toLines(null,null,t),this.mid_search(Number(t))},mid_search:function(t){var e=this;this.isSearched=!0,t=(t-1)*this.limit||0;var i={start_date:this.date[0],end_date:this.date[1]?this.getNewDay(this.date[1],1):"",form_code:this.form_code,code:this.code||"",start:t,limit:this.limit},a="";if(this.isLine)return this.toLines(this.code,1,0);a="/api/packing_reports?action=packing_list",this.$axios({url:a,params:i}).then(function(t){return 1===t.state?(e.totalMain=t.total,e.total=t.total,void(e.formdata=t.result)):alert(t.errmsg)}),this.isFilter=!1},back:function(){this.disableBack||(this.isLine=!this.isLine),this.isLine?this.total=this.totalSub:this.total=this.totalMain},toExcel:function(){var t=this;if(!this.isSearched)return alert("请先进行查询");var e="";e=this.isLine?"/api/packing_reports?action=packing_line":"/api/packing_reports?action=packing_list";var i={start_date:this.date[0]||"",end_date:this.date[1]?this.getNewDay(this.date[1],1):"",code:this.code,format:"excel"};this.$axios({url:e,responseType:"blob",params:i}).then(function(e){if(0===e.state)return alert(e.errmsg);var i=window.URL.createObjectURL(new Blob([e])),a=document.createElement("a");a.style.display="none",a.href=i;var s="";s=t.isLine?"装箱单商品明细.xlsx":"装箱单.xlsx",a.setAttribute("download",s),document.body.appendChild(a),a.click()})}}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"report_dialog"}},[i("div",{staticClass:"dialog_head"},[t._m(0),t._v(" "),i("ul",{staticClass:"dialog_icons"},[i("li",[i("i",{staticClass:"fa fa-close",attrs:{"aria-hidden":"true"},on:{click:function(e){t.closeDialog()}}})])])]),t._v(" "),i("div",{staticClass:"buttons-wrap"},[i("el-button-group",[i("el-button",{attrs:{plain:"",icon:"el-icon-arrow-left",size:"mini"},on:{click:function(e){t.back()}}}),t._v(" "),i("el-button",{attrs:{plain:"",size:"mini"}},[i("i",{staticClass:"el-icon-arrow-right el-icon--right",on:{click:function(e){t.back()}}})])],1),t._v(" "),i("el-button-group",[i("el-button",{attrs:{plain:"",icon:"el-icon-download",size:"mini"},on:{click:function(e){t.toExcel()}}}),t._v(" "),i("el-button",{attrs:{plain:"",icon:"el-icon-search",size:"mini"},on:{click:function(e){t.isFilter=!0}}})],1)],1),t._v(" "),i("el-row",{staticStyle:{padding:"0 5px"},attrs:{gutter:20}},[i("el-col",{attrs:{span:12}},[i("el-date-picker",{attrs:{size:"mini","value-format":"yyyy/MM/dd",type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t._v(" "),i("el-col",{attrs:{span:8}},[i("el-input",{attrs:{placeholder:"销售单单号",size:"mini"},model:{value:t.form_code,callback:function(e){t.form_code=e},expression:"form_code"}})],1),t._v(" "),i("el-col",{attrs:{span:4}},[i("el-button",{attrs:{icon:"el-icon-refresh",size:"mini",circle:"",type:"primary",plain:""},on:{click:function(e){t.mid_search()}}})],1)],1),t._v(" "),i("div",{staticClass:"mid-container"},[t.isLine?i("table",{staticClass:"table line-table"},[t._m(1),t._v(" "),i("tbody",t._l(t.linesFormData,function(e){return i("tr",[i("td",[t._v(t._s(e.code))]),t._v(" "),i("td",[t._v(t._s(e.product_name))]),t._v(" "),i("td",[t._v(t._s(e.packing_quantity))])])}))]):i("table",{staticClass:"table"},[i("thead",[i("tr",t._l(t.titles,function(e){return i("th",{attrs:{width:e.width}},[t._v(t._s(e.name))])}))]),t._v(" "),i("tbody",t._l(t.formdata,function(e){return i("tr",{on:{dblclick:function(i){t.toLines(e.code,1,1)}}},[i("td",[t._v(t._s(e.form_code))]),t._v(" "),i("td",[t._v(t._s(e.code))]),t._v(" "),i("td",[t._v(t._s(e.partner_name))]),t._v(" "),i("td",[t._v(t._s(e.store_name))]),t._v(" "),i("td",[t._v(t._s(e.box_count)+"/"+t._s(e.box_id))]),t._v(" "),i("td",[t._v(t._s(e.created_at))]),t._v(" "),i("td",[t._v(t._s(e.created_user))]),t._v(" "),i("td",[t._v(t._s(e.executed_at))]),t._v(" "),i("td",[t._v(t._s(e.executed_user))])])}))])]),t._v(" "),i("div",{staticClass:"footer-container"},[i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}})],1)]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isFilter,expression:"isFilter"}],staticClass:"filter-container"},[i("div",{staticClass:"filter"},[i("div",{staticClass:"dialog_head"},[t._m(2),t._v(" "),i("ul",{staticClass:"dialog_icons"},[i("li",[i("i",{staticClass:"fa fa-close",attrs:{"aria-hidden":"true"},on:{click:function(e){t.isFilter=!1}}})])])]),t._v(" "),i("div",{staticClass:"dialog_content"},[i("form",{attrs:{name:"filterform",id:"filterform"},on:{submit:function(e){e.preventDefault(),t.mid_search()}}},[i("div",{staticClass:"editor-label"},[i("label",[t._v("开始时间：")]),t._v(" "),i("el-date-picker",{attrs:{type:"date","value-format":"yyyy/MM/dd",placeholder:"选择开始时间"},model:{value:t.date2.start_date,callback:function(e){t.$set(t.date2,"start_date",e)},expression:"date2.start_date"}})],1),t._v(" "),i("div",{staticClass:"editor-label"},[i("label",[t._v("结束时间：")]),t._v(" "),i("el-date-picker",{attrs:{type:"date","value-format":"yyyy/MM/dd",placeholder:"选择结束时间"},model:{value:t.date2.end_date,callback:function(e){t.$set(t.date2,"end_date",e)},expression:"date2.end_date"}})],1),t._v(" "),i("div",{staticClass:"editor-label"},[i("label",[t._v("销售单号：")]),t._v(" "),i("el-input",{model:{value:t.form_code,callback:function(e){t.form_code=e},expression:"form_code"}})],1),t._v(" "),i("div",{staticClass:"editor-label"},[i("label",[t._v("装箱单号：")]),t._v(" "),i("el-input",{model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),t._v(" "),i("div",{staticClass:"btn-label"},[i("el-button",{attrs:{round:"",size:"mini"},on:{click:function(e){t.mid_search()}}},[t._v("确定")]),t._v(" "),i("el-button",{attrs:{round:"",size:"mini"},on:{click:function(e){t.isFilter=!1}}},[t._v("取消")])],1)])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",{staticClass:"name"},[this._v("装箱单查询")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("装箱单号")]),this._v(" "),e("th",[this._v("商品名称")]),this._v(" "),e("th",[this._v("装箱数量")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",{staticClass:"name"},[this._v("过滤条件")])])}]};var m=i("VU/8")(h,p,!1,function(t){i("mVST")},"data-v-25a07b34",null).exports,v=i("mvHQ"),f=i.n(v),g={name:"BillDialog",mixins:[_.a],data:function(){return{barcode:"",boldNumber:"boldNumber",tmpName:"BillDialog",titles:[{name:"商品名及产品码",style:"width:20%;"},{name:"京东商品名称",style:"width:25%;"},{name:"京东商品编码",style:"width:8.3%"},{name:"总数量",style:"width:8.3%"},{name:"剩余数量",style:"width:8.3%"},{name:"装箱数量",style:"width:8.3%"},{name:"重量(kg)",style:"width:8.3%"},{name:"体积",style:"width:13.3%"}],packing_list_lines:[],t_res:[],index:0,total_quantity:"",total_weight:"",total_packed:"",product_packed:"",rowspan:"",isExecuted:!1,t_id:""}},props:["res","token"],mounted:function(){var t=this;eventBus.$on("getSatus",function(e,i){t.isExecuted=6===e,t.res.form_code=i}),this.showRow()},methods:{c_goodsBtn:function(){if(!this.isExecuted)return alert("请先执行再打印");var t=this.res.id,e=this.token,i="/api/packing_lists/"+t+"?action=print&form_name=tag";this.printPDF(i,e)},moveFocus:function(){document.getElementById("SKU").focus()},rest:function(){var t=this.packing_list_lines[0].product_lines.length;this.rowspan=t;for(var e=0;e<t;e++){for(var i=document.getElementsByClassName("quantity"+e)[0],a=document.getElementsByName("unpacked"+e),s=Array.prototype.slice.call(document.getElementsByClassName("packed"+e)),n=Number(i.getAttribute("data-item")),r=[],o=0,l=0;l<s.length;l++)r.push(Number(s[l].value)),o=this.sum(r);for(var c=n-o,d=Array.prototype.slice.call(a),u=0;u<d.length;u++){if(d[u].innerHTML=c,c<0)return alert("剩余数量不能小于0");0===c?(d[u].parentNode.classList.remove("whiteBgc"),d[u].parentNode.classList.add("greenBgc")):(d[u].parentNode.classList.remove("greenBgc"),d[u].parentNode.classList.add("whiteBgc")),this.packing_list_lines[u].product_lines[e].outcome=c}}},c_weighBtn:function(){document.getElementsByClassName("weight")[this.index].focus()},searchSKU:function(){for(var t=this.barcode,e=this.packing_list_lines[this.index].product_lines,i=0;i<e.length;i++)if(t==e[i].barcode)return document.getElementsByName(t)[this.index].focus();this.$message.error("未查询到产品码!")},aBox:function(){if(6!==this.res.status)if(0!==this.total_rest){if(!this.saveBeforeAdd())return alert("装箱数量全部为0，请检查");for(var t=this.packing_list_lines.length,e=JSON.parse(f()(this.packing_list_lines[t-1])),i=0;i<e.product_lines.length;i++)e.product_lines[i].packing_quantity=0,e.product_lines[i].id="";e.id="",e.code="",e.weight=0,this.packing_list_lines.push(e),this.index=this.packing_list_lines.length-1,this.moveFocus()}else this.$message({type:"warning",message:"剩余数量已为0"});else this.$message({type:"warning",message:"已执行的装箱单不能修改!"})},mBox:function(){var t=this;if(6!==this.res.status){if(confirm("确定要删除第"+(this.index+1)+"箱？"))return this.packing_list_lines[this.index].id?void this.$axios({url:"/api/packing_lists/"+this.res.id+"/packing_list_lines/"+this.packing_list_lines[this.index].id,method:"DELETE"}).then(function(e){return 1===e.state?(t.$message({type:"success",message:"删除成功!"}),t.packing_list_lines.splice(t.index,1),void t.showRow()):alert(e.errmsg)}):(this.packing_list_lines.splice(this.index,1),void this.showRow())}else this.$message({type:"warning",message:"已执行的装箱单不能修改!"})},isThisBox:function(t){if(t==this.index)return!0},c_saveBoxButton:function(){this.saveBeforeAdd()},c_saveButton:function(){var t=this;return c()(o.a.mark(function e(){var i,a,s,n,r,l,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(confirm("确定已经完成装箱，将保存整箱？")){e.next=2;break}return e.abrupt("return");case 2:for(i=t.res.id,s=t.packing_list_lines,console.time("packing_list_lines"),n=0,r=s.length;n<r;n++)for(l=0,c=s[n].product_lines.length;l<c;l++)s[n].product_lines[l].packing_quantity=s[n].product_lines[l].packing_quantity||0;return console.timeEnd("packing_list_lines"),a={packing_list_lines:s},e.next=10,t.$axios.put("/api/packing_lists/"+i,a).then(function(e){if(1!==e.state)return alert(e.errmsg);t.$message({type:"success",message:"此箱保存成功!"})});case 10:case"end":return e.stop()}},e,t)}))()},c_executeBtn:function(){var t=this,e=this.res.id;this.$axios.get("/api/packing_lists/"+e+"?action=execute").then(function(e){return 1===e.state?(t.$message({type:"success",message:"执行成功!"}),t.isExecuted=!0,void eventBus.$emit("changeisExecuted",t.isExecuted)):alert(e.errmsg)})},saveBeforeAdd:function(){for(var t=this,e=this.res.id,i={},a=this.packing_list_lines[this.index],s=a.id||"",n=a,r=!1,o=0,l=n.product_lines.length;o<l;o++)n.product_lines[o].packing_quantity=n.product_lines[o].packing_quantity||0,n.product_lines[o].packing_quantity?r=!0:n.product_lines[o].packing_quantity=0;return!!r&&("number"!=typeof s?(i={url:"/api/packing_lists/"+e+"/packing_list_lines",method:"POST",data:{packing_list_lines:n}},this.$axios(i).then(function(e){if(1!==e.state)return alert(e.errmsg);t.packing_list_lines[t.index].id=e.id;for(var i=0,a=e.product_lines.length;i<a;i++)t.packing_list_lines[t.index].product_lines[i].id=e.product_lines[i].id;t.$message({type:"success",message:"保存成功!"})})):(i={url:"/api/packing_lists/"+e+"/packing_list_lines/"+s,method:"PUT",data:{packing_list_lines:n}},this.$axios(i).then(function(e){if(1!==e.state)return alert(e.errmsg);t.$message({type:"success",message:"保存成功!"})})))},c_batchPrintBtn:function(){if(0==this.isExecuted)return alert("请先执行");var t=this.res.id,e=this.token,i="/api/packing_lists/"+t+"?action=print&form_name=packing_list";this.printPDF(i,e)},showRow:function(t){t=t||0,this.index=t},_open:function(t){var e=this;this.$axios({url:"/api/packing_lists/"+t+"/packing_list_lines"}).then(function(t){if(!t.state)return alert(t.errmsg);e.t_res=t,e.total_quantity=t.total_quantity,e.packing_list_lines=t.packing_list_lines,e.$nextTick(function(){e.rest()}),e.moveFocus()})}},computed:{total_rest:function(){return this.total_quantity-this.total_packed}},watch:{packing_list_lines:{handler:function(t,e){for(var i=this,a=0,s=0,n=this.packing_list_lines,r=0,o=n.length;r<o;r++){for(var l=0,c=n[r].product_lines.length;l<c;l++){var d=n[r].product_lines[l].packing_quantity;a+=Number(d),n[r].product_lines[l].packing_quantity=d||""}s+=Number(n[r].weight)}return this.total_packed=a,this.total_weight=s,this.$nextTick(function(){i.rest()}),t},deep:!0}}},k={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dialog bill_widget",attrs:{id:"bill_dialog"}},[i("div",{staticClass:"dialog_head"},[t._m(0),t._v(" "),i("ul",{staticClass:"dialog_icons"},[i("li",[i("i",{staticClass:"fa fa-close",attrs:{"aria-hidden":"true"},on:{click:function(e){t.closeDialog()}}})])])]),t._v(" "),i("div",{staticClass:"dialog_content",staticStyle:{height:"400px"}},[i("div",{staticClass:"barcodeContainer",attrs:{id:"container"}},[i("div",{attrs:{id:"closeMain"}},[i("div",{attrs:{id:"billContainer"}},[i("div",{staticClass:"tabwidget"},[i("div",{staticClass:"editor-label",staticStyle:{width:"400px"}},[i("label",[t._v("产品码：")]),t._v(" "),i("el-input",{attrs:{clearable:"",id:"SKU",autofocus:"isFocus"},on:{focus:function(e){t.barcode=""}},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.searchSKU()}},model:{value:t.barcode,callback:function(e){t.barcode="string"==typeof e?e.trim():e},expression:"barcode"}}),t._v(" "),i("i",{staticClass:"fa fa-search fa-lg search",attrs:{id:"searchBarcode"},on:{click:function(e){t.searchSKU()}}})],1),t._v(" "),i("div",{staticClass:"editor-label status"},[i("label",[t._v("状态：")]),t._v(" "),6==t.res.status?i("el-tag",{attrs:{type:"success"}},[i("i",{staticClass:"el-icon-success"}),t._v(" 已完成")]):i("el-tag",{attrs:{type:"danger"}},[i("i",{staticClass:"el-icon-warning"}),t._v(" 未完成")])],1),t._v(" "),i("div",{staticClass:"mid-container"},[i("div",{staticClass:"left"},[i("div",{staticClass:"left-title"},[t._v("装箱单序号")]),t._v(" "),i("ul",t._l(t.packing_list_lines,function(e,a){return i("li",{class:a==t.index?"active":"",on:{click:function(e){t.showRow(a)}}},[t._v("第"+t._s(a+1)+"箱")])})),t._v(" "),i("div",{staticClass:"left-btn"},[i("div",{on:{click:function(e){t.aBox()}}},[i("i",{staticClass:"fa fa-plus-square",attrs:{"aria-hidden":"true"}}),t._v(" 新增")]),t._v(" "),i("div",{on:{click:function(e){t.mBox()}}},[i("i",{staticClass:"fa fa-minus-square",attrs:{"aria-hidden":"true"}}),t._v(" 删除")])])]),t._v(" "),i("div",{staticClass:"right"},[i("table",{staticClass:"fake-head"},[i("thead",[i("tr",t._l(t.titles,function(e){return i("th",{style:e.style},[t._v(t._s(e.name))])}))])]),t._v(" "),t._l(t.packing_list_lines,function(e,a){return i("table",{directives:[{name:"show",rawName:"v-show",value:t.isThisBox(a),expression:"isThisBox(index)"}],attrs:{border:"1"}},[i("thead",[i("tr",{staticStyle:{height:"40px"}},t._l(t.titles,function(e){return i("th",{style:e.style},[t._v(t._s(e.name))])}))]),t._v(" "),i("tbody",[t._l(e.product_lines,function(a,s){return i("tr",[i("td",{staticStyle:{"text-align":"left"}},[t._v("【"+t._s(a.barcode)+"】："+t._s(a.name))]),t._v(" "),i("td",{staticStyle:{"text-align":"left"},attrs:{title:a.product_name}},[t._v(t._s(a.product_name))]),t._v(" "),i("td",[t._v(t._s(a.product_code))]),t._v(" "),i("td",{class:["quantity"+s,t.boldNumber],attrs:{"data-item":a.quantity}},[t._v(t._s(a.quantity))]),t._v(" "),i("td",{staticClass:"boldNumber",attrs:{name:"unpacked"+s}}),t._v(" "),i("td",[i("input",{directives:[{name:"model",rawName:"v-model.number",value:a.packing_quantity,expression:"product.packing_quantity",modifiers:{number:!0}}],class:["packed"+s,t.boldNumber],attrs:{type:"number",name:a.barcode,"data-item":a.packing_quantity,min:"0",step:"1"},domProps:{value:a.packing_quantity},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.moveFocus()},focus:function(t){a.packing_quantity=""},input:function(e){e.target.composing||t.$set(a,"packing_quantity",t._n(e.target.value))},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),0==s?i("td",{attrs:{rowspan:t.rowspan}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.weight,expression:"box.weight"}],staticClass:"weight boldNumber",staticStyle:{border:"none",outline:"none","text-align":"center"},domProps:{value:e.weight},on:{focus:function(t){e.weight=""},input:function(i){i.target.composing||t.$set(e,"weight",i.target.value)}}})]):t._e(),t._v(" "),0==s?i("td",{attrs:{rowspan:t.rowspan}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.volume,expression:"box.volume"}],staticClass:"weight boldNumber",staticStyle:{border:"none",outline:"none","text-align":"center",width:"100%"},attrs:{title:e.volume},domProps:{value:e.volume},on:{focus:function(t){e.volume=""},input:function(i){i.target.composing||t.$set(e,"volume",i.target.value)}}})]):t._e()])}),t._v(" "),i("tr",{staticStyle:{height:"30px"}},[i("td",{attrs:{colspan:"3"}},[t._v("合计")]),t._v(" "),i("td",{staticClass:"boldNumber"},[t._v(t._s(t.total_quantity))]),t._v(" "),i("td",{staticClass:"boldNumber"},[t._v(t._s(t.total_rest))]),t._v(" "),i("td",{staticClass:"boldNumber"},[t._v(t._s(t.total_packed))]),t._v(" "),i("td",{staticClass:"boldNumber"},[t._v(t._s(t.total_weight))]),t._v(" "),i("td",{staticClass:"boldNumber"},[t._v("-")])])],2)])})],2)]),t._v(" "),i("div",{staticClass:"table_btn"},[i("el-button",{attrs:{type:"primary",size:"medium",disabled:t.isExecuted},on:{click:function(e){t.c_weighBtn()}}},[t._v("称重")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"medium",disabled:t.isExecuted},on:{click:function(e){t.c_saveBoxButton()}}},[t._v("保存本箱")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"medium",disabled:t.isExecuted},on:{click:function(e){t.c_executeBtn()}}},[t._v("执行")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"medium",disabled:!t.isExecuted},on:{click:function(e){t.c_batchPrintBtn()}}},[t._v("打印装箱单")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"medium",disabled:!t.isExecuted},on:{click:function(e){t.c_goodsBtn()}}},[t._v("打印箱标")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"medium",disabled:t.isExecuted},on:{click:function(e){t.c_saveButton()}}},[t._v("保存整单")])],1)])])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("span",{staticClass:"name"},[this._v("装箱单录入")])])}]};var b=i("VU/8")(g,k,!1,function(t){i("iTdY")},"data-v-21f4f94b",null).exports,y={name:"App",mixins:[_.a],components:{ReportDialog:m,BillDialog:b},props:["token"],mounted:function(){var t=this;eventBus.$on("changeisExecuted",function(e){1==e&&(t.res.status=6)}),eventBus.$on("f-close-dialog",function(e,i){t.diglogTrigger(e,i)}),eventBus.$on("openFilter",function(e){t.show_Filter=e})},data:function(){return{show_WorkspacefilterDialog:!1,show_PartnerDialog:!1,show_BillDialog:!1,show_ReportDialog:!1,show_Filter:!1,isSearched:!1,res:{},container:[],short_no:"",list:[{name:"单号",key:"form_code",value:"",readonly:!0},{name:"仓库",key:"store_name",value:"",readonly:!0},{name:"商业伙伴",key:"partner_name",value:"",readonly:!0},{name:"联系人",key:"contactor",value:""},{name:"联系电话",key:"phone",value:""},{name:"手机号",key:"mobile_phone",value:""},{name:"数量",key:"total_quantity",value:"",readonly:!0},{name:"京东订单单号",key:"order_id",value:"",readonly:!0},{name:"TC预约号",key:"tc_code",value:"",nameStyle:"font-weight: bold;"},{name:"TC预约送货日期",key:"tc_date",value:"",style:"display: inline;",nameStyle:"font-weight: bold;",datePicker:!0},{name:"目的城市",key:"des",value:"",readonly:!0},{name:"目的仓库",key:"store",value:"",readonly:!0},{name:"省",key:"province",value:""},{name:"市",key:"city",value:""},{name:"区",key:"district",value:""},{name:"街道",key:"town",value:""},{name:"详细地址",key:"shipping_address",value:"",class:"shipping_address"},{name:"备注",key:"memo",value:"",class:"memo"}],id:""}},methods:{clear:function(){this.short_no=""},c_scanBtn:function(){if(""==this.short_no)return alert("请输入短单号查询");6!==this.res.status?this.onSave():this.$refs.BillDialog._open(this.res.id),this.diglogTrigger("BillDialog",!0)},c_boxCheckBtn:function(){this.diglogTrigger("ReportDialog",!0)},upDate:function(t){if(1===t.state){this.res=t,this.container=this.list;for(var e=0,i=this.container.length;e<i;e++)for(var a in t)this.container[e].key==a&&(this.container[e].value=t[a]);this.list=this.container,this.container=[]}else alert(t.errmsg)},onSave:function(){for(var t=this,e={},i={},a=0,s=this.list.length;a<s;a++){e[this.list[a].key]=this.list[a].value}e=u()({},this.res,e),i=null!=this.res.id?{url:"/api/packing_lists/"+this.res.id,method:"PUT",data:e}:{url:"/api/packing_lists",method:"POST",data:e},this.$axios(i).then(function(e){if(1!==e.state)return alert(e.errmsg);t.upDate(e),t.res=e,t.$refs.BillDialog._open(e.id),t.$message({type:"success",message:"保存成功!"})})},short_no_search:function(){var t=this;return c()(o.a.mark(function e(){var i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.short_no){e.next=4;break}return e.abrupt("return",alert("请输入短单号"));case 4:return e.next=6,t.$axios({url:"/api/packing_lists",params:{short_no:t.short_no}});case 6:if((i=e.sent).state){e.next=12;break}return alert(i.errmsg),e.abrupt("return");case 12:t.isSearched=!0,t.upDate(i),eventBus.$emit("getSatus",i.status,i.form_code);case 15:return e.next=17,t.c_scanBtn();case 17:case"end":return e.stop()}},e,t)}))()}}},x={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"input-code editor-label"},[i("label",{staticStyle:{width:"auto"}},[t._v("短单号：")]),t._v(" "),i("el-input",{staticStyle:{width:"52%"},attrs:{autofocus:"",resize:""},on:{focus:function(e){t.short_no=""}},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.short_no_search()}},model:{value:t.short_no,callback:function(e){t.short_no="string"==typeof e?e.trim():e},expression:"short_no"}}),t._v(" "),i("i",{staticClass:"fa fa-search fa-lg",attrs:{"aria-hidden":"true"},on:{click:function(e){t.short_no_search()}}})],1),t._v(" "),i("div",{attrs:{id:"tab1"}},[i("el-button",{attrs:{plain:"",type:"primary"},on:{click:function(e){t.c_scanBtn()}}},[t._v("装箱及打印")]),t._v(" "),i("el-button",{attrs:{plain:"",type:"primary"},on:{click:function(e){t.c_boxCheckBtn()}}},[t._v("装箱单查询")])],1),t._v(" "),i("div",{staticClass:"order-form"},[i("form",{staticClass:"border_radius clearfix billform",attrs:{id:"mainTable"}},[t._l(t.list,function(e){return i("div",{staticClass:"editor-label"},[i("label",{style:e.nameStyle},[t._v(t._s(e.name)+"：")]),t._v(" "),e.datePicker?i("el-date-picker",{style:e.style,attrs:{type:"date","value-format":"yyyy/MM/dd",placeholder:"选择日期"},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"inputItem.value"}}):i("el-input",{class:e.class,attrs:{readonly:e.readonly},model:{value:e.value,callback:function(i){t.$set(e,"value","string"==typeof i?i.trim():i)},expression:"inputItem.value"}})],1)}),t._v(" "),i("div",{staticClass:"form-btn"},[i("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(e){e.preventDefault(),t.onSave()}}},[t._v("保存")])],1)],2)]),t._v(" "),t.show_ReportDialog?i("ReportDialog"):t._e(),t._v(" "),i("BillDialog",{directives:[{name:"show",rawName:"v-show",value:t.show_BillDialog,expression:"show_BillDialog"}],ref:"BillDialog",attrs:{res:t.res,token:t.token}})],1)},staticRenderFns:[]};var w=i("VU/8")(y,x,!1,function(t){i("tcah")},null,null).exports,C=i("mtWM"),B=i.n(C),$=i("zL8q"),D=i.n($);i("tvR6");n.default.config.productionTip=!1,n.default.prototype.$axios=B.a,n.default.use(D.a),window.addEventListener("message",function(t){var e;e=JSON.parse(t.data),window.eventBus=new n.default,new n.default({el:"#app",components:{App:w},mixins:[_.a],template:'<App :token="token"/>',data:{token:"",partner:"",store:""},mounted:function(){this.getToken(),this.interceptors()},methods:{getToken:function(){var t=this,i=document.referrer,a=i.slice(0,i.indexOf("/static")),s=e.user;this.$axios({url:"/api/access_token",params:{url:a,set_of_book:s.set_of_book,user_name:s.name},headers:{Token:s.token}}).then(function(e){1===e.data.state?t.token=e.data.token:alert(e.data.errmsg)}).catch(function(t){console.log(t)})},interceptors:function(){var t=this;this.$axios.interceptors.request.use(function(e){return e.headers.Token=t.token,t.$loading({text:"加载中...",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.9)"}),e},function(t){return s.a.reject(t)}),this.$axios.interceptors.response.use(function(e){return t.$loading({text:"加载中...",background:"rgba(255, 255, 255, 0.9)"}).close(),e.data},function(t){return s.a.reject(t.response)})}}})},!1)},ShJz:function(t,e){},iTdY:function(t,e){},mVST:function(t,e){},tcah:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.6ebad129acac61ab2748.js.map